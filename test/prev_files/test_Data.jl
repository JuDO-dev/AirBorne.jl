@testset "Data" begin
    @testset "get_data" begin
        data = get_data("AAPL", "2016-07-11", "2021-07-10", "", "1d")
        adj_close = data[:, 6]
        @test isapprox(adj_close,
            [22.520648956298828, 22.622825622558594, 22.495105743408203, 22.940967559814453, 22.938640594482422, 23.18246841430664, 23.1917667388916, 23.212661743164062, 23.089588165283203, 22.91077995300293, 22.604248046875, 22.44865608215332, 23.907001495361328, 24.229782104492188, 24.199594497680664, 24.62687873840332, 24.262290954589844, 24.566505432128906, 24.718263626098633, 25.094161987304688, 25.301959991455078, 25.404682159423828, 25.215572357177734, 25.199228286743164, 25.257593154907227, 25.56111717224121, 25.537769317626953, 25.500408172607422, 25.467721939086914, 25.533100128173828, 25.334644317626953, 25.41402244567871, 25.222572326660156, 25.11517333984375, 24.96807861328125, 24.940067291259766, 24.748613357543945, 24.77196502685547, 24.919052124023438, 25.15253257751465, 25.145526885986328, 25.299617767333984, 24.636547088623047, 24.078529357910156, 24.61786651611328, 25.20389747619629, 26.095775604248047, 26.982994079589844, 26.83123779296875, 26.518373489379883, 26.51603889465332, 26.511369705200195, 26.76119041442871, 26.315244674682617, 26.354938507080078, 26.403968811035156, 26.604759216308594, 26.19150733947754, 26.394630432128906, 26.27088737487793, 26.382957458496094, 26.394630432128906, 26.59075164794922, 26.630443572998047, 27.09506607055664, 27.15343475341797, 27.396249771118164, 27.312198638916016, 27.46395492553711, 27.445281982421875, 27.426605224609375, 27.344884872436523, 27.33087730407715, 27.22347640991211, 27.468626022338867, 27.60871124267578, 26.98766326904297, 26.72850799560547, 26.551063537597656, 26.509035110473633, 26.030406951904297, 26.053752899169922, 25.774492263793945, 25.542160034179688, 25.91060447692871, 26.063138961791992, 26.020898818969727, 25.29574966430664, 25.44594383239746, 24.807619094848633, 25.136171340942383, 25.81203842163086, 25.802650451660156, 25.82846450805664, 26.220375061035156, 26.236804962158203, 26.103038787841797, 26.234455108642578, 26.18282699584961, 26.157012939453125, 25.936412811279297, 25.6946964263916, 25.790918350219727, 25.605520248413086, 25.802650451660156, 26.056100845336914, 26.31190299987793, 26.741355895996094, 26.588815689086914, 27.0323543548584, 27.0323543548584, 27.18019676208496, 27.21540641784668, 27.37263298034668, 27.44538116455078, 27.47119903564453, 27.290496826171875, 27.344472885131836, 27.51813316345215, 27.40079689025879, 27.393756866455078, 27.18019676208496, 27.257640838623047, 27.22713279724121, 27.365596771240234, 27.67067527770996, 27.924121856689453, 27.952281951904297, 28.102476119995117, 27.985139846801758, 27.93585777282715, 28.161148071289062, 28.15880012512207, 28.109521865844727, 28.161148071289062, 28.179916381835938, 28.15410614013672, 28.60233497619629, 28.61641502380371, 28.618762969970703, 28.543670654296875, 28.477962493896484, 30.214567184448242, 30.162933349609375, 30.292011260986328, 30.575963973999023, 30.86696434020996, 30.986644744873047, 31.21055793762207, 31.13984489440918, 31.415605545043945, 31.823366165161133, 31.938852310180664, 31.901142120361328, 31.988353729248047, 32.21932601928711, 32.31595993041992, 32.17926025390625, 32.20988845825195, 32.27353286743164, 32.28767776489258, 32.94761657714844, 32.75199508666992, 32.945255279541016, 32.841556549072266, 32.88398361206055, 32.761417388916016, 32.685997009277344, 32.79441452026367, 32.808555603027344, 32.75906753540039, 33.10554122924805, 33.15974044799805, 32.99475860595703, 33.34123229980469, 32.95940399169922, 33.331809997558594, 33.21394729614258, 33.1479606628418, 33.20452880859375, 33.89274597167969, 33.96816635131836, 33.92338943481445, 33.85975646972656, 33.86917495727539, 34.12138366699219, 33.94459915161133, 33.85975646972656, 33.784324645996094, 33.7442626953125, 33.38129806518555, 33.42136764526367, 33.24460220336914, 33.428428649902344, 33.279945373535156, 33.157379150390625, 33.57221221923828, 33.53214645385742, 33.85504150390625, 34.06480026245117, 33.864463806152344, 33.89038848876953, 33.857391357421875, 34.547977447509766, 34.76716613769531, 34.66111373901367, 34.53619384765625, 35.10893630981445, 36.06349563598633, 36.294471740722656, 
            36.122406005859375, 36.43480682373047, 36.94364929199219, 36.848976135253906, 36.794551849365234, 35.55914306640625, 36.10111618041992, 36.22418212890625, 36.444278717041016, 36.3993034362793, 36.29043960571289, 36.41587829589844, 36.35434341430664, 36.36853790283203, 36.15317916870117, 36.2525749206543, 36.7898063659668, 36.430084228515625, 36.55314636230469, 36.77086639404297, 36.68094253540039, 35.258575439453125, 34.41604995727539, 34.69295120239258, 34.35451126098633, 34.14860916137695, 33.67055130004883, 34.633785247802734, 34.31901931762695, 34.522544860839844, 34.46574401855469, 34.61957550048828, 34.51071548461914, 34.01607894897461, 34.51307678222656, 34.00424575805664, 34.084712982177734, 33.961647033691406, 34.10129165649414, 33.779415130615234, 
            34.12257766723633, 34.330848693847656, 34.442081451416016, 34.491783142089844, 34.97221374511719, 35.27277755737305, 35.395851135253906, 35.518917083740234, 35.74138259887695, 35.58045196533203, 35.56388473510742, 35.99460220336914, 36.1484489440918, 36.31884765625, 35.63250732421875, 35.38164138793945, 35.19941711425781, 35.51182174682617, 37.189781188964844, 36.818214416503906, 37.01228332519531, 37.58501434326172, 37.885581970214844, 38.11751174926758, 36.90340042114258, 37.41660690307617, 37.979705810546875, 38.39550018310547, 38.24106979370117, 37.50688934326172, 37.421356201171875, 37.352455139160156, 37.96307373046875, 38.010581970214844, 37.84190368652344, 37.982078552246094, 38.3646125793457, 38.70674514770508, 38.811302185058594, 38.965721130371094, 38.977603912353516, 38.509552001953125, 38.46915054321289, 38.314720153808594, 37.68983459472656, 38.371734619140625, 38.21967697143555, 37.93218994140625, 37.6066780090332, 37.98683166503906, 37.699344635009766, 37.713600158691406, 37.08159255981445, 36.444828033447266, 36.088443756103516, 35.77006912231445, 36.385440826416016, 36.644412994384766, 36.418704986572266, 36.6182746887207, 36.54462432861328, 36.70381164550781, 36.466224670410156, 36.92002868652344, 36.898651123046875, 37.02694320678711, 37.041194915771484, 37.19564437866211, 37.06495666503906, 37.3001823425293, 37.98683166503906, 38.12702178955078, 37.95833206176758, 
            37.060203552246094, 37.12436294555664, 37.10535430908203, 37.32632827758789, 37.162376403808594, 37.39997482299805, 38.74000930786133, 39.61198425292969, 40.163204193115234, 39.65238952636719, 39.9422492980957, 40.98529815673828, 41.40108871459961, 41.53413772583008, 41.873905181884766, 41.788368225097656, 41.65006637573242, 41.483150482177734, 40.85602951049805, 40.317138671875, 40.79880905151367, 40.572269439697266, 40.531742095947266, 41.28524398803711, 41.71921157836914, 41.72160339355469, 41.51176452636719, 41.26853942871094, 40.412513732910156, 40.977638244628906, 40.78688430786133, 40.48881530761719, 40.45066833496094, 40.300445556640625, 40.374366760253906, 40.38628005981445, 41.17317199707031, 40.941871643066406, 41.077796936035156, 41.06586837768555, 41.483150482177734, 42.06734848022461, 41.619056701660156, 41.573768615722656, 41.73114013671875, 41.73114013671875, 40.672428131103516, 40.679569244384766, 40.794029235839844, 40.35289764404297, 41.07540512084961, 41.06825256347656, 41.25900650024414, 
            41.728755950927734, 41.573768615722656, 41.56898880004883, 41.5594596862793, 41.79551696777344, 42.22711181640625, 42.01251983642578, 42.7064094543457, 42.74455642700195, 42.55379867553711, 42.20566177368164, 42.2151985168457, 41.542762756347656, 40.80118942260742, 40.896568298339844, 40.05006408691406, 39.81400680541992, 39.92369079589844, 40.007144927978516, 38.2712287902832, 37.31504821777344, 38.87451171875, 38.042320251464844, 36.99552536010742, 37.44803237915039, 38.956390380859375, 39.346649169921875, 40.07210159301758, 41.41765213012695, 41.283573150634766, 41.144710540771484, 40.95796585083008, 41.30033874511719, 42.01859664916992, 42.849388122558594, 42.71052932739258, 42.6458854675293, 41.89888000488281, 42.18859100341797, 42.33464431762695, 42.29872131347656, 41.90607833862305, 42.36336898803711, 43.091209411621094, 43.5078125, 43.08882141113281, 42.72250747680664, 42.77278137207031, 42.6219482421875, 41.970726013183594, 41.956356048583984, 41.0058479309082, 40.42644119262695, 39.49030303955078, 41.3649787902832, 40.304344177246094, 39.859012603759766, 40.170257568359375, 39.90690231323242, 40.316322326660156, 41.08724594116211, 41.372161865234375, 40.31391906738281, 40.713748931884766, 41.47990798950195, 41.28596115112305, 41.6929931640625, 41.83424758911133, 42.09522247314453, 42.67461395263672, 42.5788459777832, 41.372161865234375, 39.67704772949219, 39.562129974365234, 
            39.01145935058594, 39.18144607543945, 39.31792068481445, 38.863014221191406, 39.56691360473633, 40.486297607421875, 42.2747802734375, 42.35139083862305, 44.01298522949219, 44.331424713134766, 44.544490814208984, 44.8581428527832, 45.49979019165039, 45.32674789428711, 45.22099685668945, 44.81000518798828, 45.22821044921875, 44.942203521728516, 44.77876663208008, 45.09601593017578, 44.98305892944336, 45.27147674560547, 45.22099685668945, 45.324344635009766, 45.16091537475586, 45.06477355957031, 44.913352966308594, 45.723323822021484, 46.105464935302734, 46.461181640625, 46.622215270996094, 46.49723815917969, 46.07422637939453, 45.96126174926758, 46.213619232177734, 45.83386993408203, 45.857913970947266, 45.386837005615234, 45.36280822753906, 44.6297492980957, 
            44.82442092895508, 44.5744743347168, 44.444679260253906, 43.78372573852539, 44.326908111572266, 44.26202392578125, 44.58407974243164, 44.49034881591797, 44.98786163330078, 44.2043342590332, 44.5600471496582, 45.177738189697266, 45.805030822753906, 45.7497673034668, 45.15610122680664, 45.91318893432617, 45.98529052734375, 45.88435363769531, 46.01414108276367, 45.761775970458984, 46.11748504638672, 46.01173782348633, 46.05259323120117, 46.38667678833008, 46.824100494384766, 46.677494049072266, 45.90117645263672, 45.64400863647461, 45.73533630371094, 48.42961883544922, 49.845252990722656, 49.98945236206055, 50.2490234375, 49.7779541015625, 49.81159591674805, 50.20336151123047, 50.05382537841797, 50.37702178955078, 50.58926773071289, 50.70744705200195, 51.45030212402344, 52.4777717590332, 51.96644592285156, 51.865142822265625, 51.8675651550293, 51.973690032958984, 52.135284423828125, 52.564598083496094, 52.98908996582031, 53.780181884765625, 54.27463150024414, 54.90171432495117, 55.077781677246094, 54.718406677246094, 53.80912399291992, 53.375, 52.658660888671875, 53.990020751953125, 53.319522857666016, 54.60746383666992, 53.987606048583984, 52.55012512207031, 52.6369514465332, 52.668304443359375, 53.06867218017578, 52.49706268310547, 53.25197982788086, 53.58964538574219, 53.16273880004883, 54.25532913208008, 54.44586944580078, 54.81247329711914, 55.29967498779297, 55.972599029541016, 54.98854446411133, 54.09614181518555, 53.970733642578125, 54.718406677246094, 52.18352127075195, 51.72285079956055, 53.570350646972656, 52.424713134765625, 53.58000183105469, 53.34845733642578, 52.10151672363281, 52.895023345947266, 53.21821594238281, 53.71988296508789, 51.87721633911133, 53.01320266723633, 52.16905212402344, 51.18982696533203, 51.44548416137695, 52.78648376464844, 53.59687805175781, 50.04176712036133, 48.62116622924805, 49.14695358276367, 50.637508392333984, 50.46082305908203, 49.487857818603516, 46.99494552612305, 46.52540969848633, 45.21118927001953, 46.32695007324219, 46.840049743652344, 44.98367691040039, 42.83445739746094, 42.78605651855469, 41.699337005615234, 42.26325988769531, 42.17129135131836, 43.79289627075195, 43.456478118896484, 43.22170639038086, 44.731971740722656, 42.7642707824707, 42.287471771240234, 40.779624938964844, 41.04827880859375, 40.813507080078125, 40.92726135253906, 41.3750114440918, 40.051109313964844, 39.67839050292969, 40.193912506103516, 38.940189361572266, 37.95755386352539, 36.481170654296875, 35.537261962890625, 38.03984451293945, 37.79297637939453, 37.81233215332031, 38.17780685424805, 38.22136688232422, 34.41423034667969, 35.88335418701172, 35.80348587036133, 36.48601531982422, 37.10560989379883, 37.224205017089844, 36.85873794555664, 36.30449295043945, 37.047523498535156, 37.500118255615234, 37.72279357910156, 37.95513916015625, 37.10319137573242, 37.25324630737305, 36.95797348022461, 38.18264389038086, 37.82928466796875, 37.43718338012695, 39.99543762207031, 
            40.28346633911133, 40.30282211303711, 41.447628021240234, 42.156768798828125, 42.17129135131836, 41.37259292602539, 41.42121124267578, 41.18299865722656, 41.537872314453125, 41.36530685424805, 41.51600646972656, 41.42363739013672, 41.547603607177734, 41.814979553222656, 41.579200744628906, 42.04346466064453, 42.349727630615234, 42.3740348815918, 42.50529479980469, 42.08720779418945, 42.529598236083984, 42.743499755859375, 42.66572189331055, 42.42021942138672, 41.92922592163086, 42.02888488769531, 43.48484802246094, 43.97342300415039, 44.167877197265625, 44.65886688232422, 45.23980712890625, 45.701637268066406, 45.3394660949707, 45.73566818237305, 47.42012405395508, 46.43813705444336, 45.876651763916016, 45.40265655517578, 45.811012268066406, 45.87178039550781, 46.17075729370117, 46.48432159423828, 47.1600456237793, 47.48332977294922, 47.56597137451172, 47.88438415527344, 48.637901306152344, 48.492061614990234, 48.7642936706543, 48.358367919921875, 48.338924407958984, 48.426429748535156, 48.43128204345703, 49.3743896484375, 49.55183792114258, 49.71468734741211, 50.431739807128906, 50.35396194458008, 49.89698791503906, 49.65877914428711, 49.734134674072266, 48.77644348144531, 51.17066955566406, 50.83766174316406, 51.469642639160156, 50.6748046875, 49.30876541137695, 49.318485260009766, 48.788604736328125, 48.112709045410156, 45.316429138183594, 46.0338020324707, 46.58524703979492, 46.380279541015625, 46.116756439208984, 44.6746826171875, 45.531150817871094, 44.59904479980469, 43.8377571105957, 43.66939163208008, 
            43.48883819580078, 43.28143310546875, 43.50591278076172, 42.7177848815918, 42.28589630126953, 43.83287811279297, 44.540496826171875, 45.194419860839844, 46.39735794067383, 46.99028778076172, 47.534423828125, 47.383140563964844, 47.373374938964844, 47.02933120727539, 47.3099365234375, 48.42259216308594, 48.281070709228516, 48.66904067993164, 48.503108978271484, 48.45431900024414, 47.71986770629883, 48.75199508666992, 48.737361907958984, 48.29326629638672, 49.17901611328125, 49.46693420410156, 49.87685012817383, 49.83293151855469, 48.80568313598633, 49.103370666503906, 49.58893585205078, 49.227806091308594, 49.60601806640625, 50.07206726074219, 49.89882278442383, 49.61821365356445, 50.18186569213867, 49.432769775390625, 50.56251525878906, 50.95779037475586, 50.91630935668945, 50.51370620727539, 50.68939971923828, 51.16275405883789, 50.94316101074219, 51.982608795166016, 50.85775375366211, 49.781700134277344, 47.17573547363281, 48.06878662109375, 48.56655502319336, 49.637733459472656, 49.22869873046875, 49.10377883911133, 51.18324279785156, 49.6597785949707, 49.41239547729492, 50.57826614379883, 51.52125930786133, 51.52370071411133, 52.08214569091797, 52.03805160522461, 49.632835388183594, 50.57582092285156, 50.005130767822266, 50.34069061279297, 51.19304275512695, 51.12691879272461, 50.38231658935547, 51.237144470214844, 52.23890686035156, 52.234004974365234, 52.45689010620117, 53.07656478881836, 54.764137268066406, 54.64167022705078, 53.57867431640625, 53.86034393310547, 54.0562858581543, 54.563297271728516, 54.11997604370117, 53.32884979248047, 53.571327209472656, 53.316593170166016, 54.13711929321289, 53.85789489746094, 53.5958251953125, 54.85721206665039, 55.009071350097656, 53.6301155090332, 54.0856819152832, 55.601802825927734, 55.61404800415039, 54.96253204345703, 55.60670471191406, 56.35618591308594, 57.85517501831055, 57.77189636230469, 57.637184143066406, 57.40449142456055, 57.62739181518555, 57.90415573120117, 58.90837097167969, 58.77366638183594, 59.56233596801758, 59.66032028198242, 60.395111083984375, 61.00008773803711, 59.58929443359375, 59.581932067871094, 60.929054260253906, 62.65827178955078, 63.06975173950195, 62.97913360595703, 63.006080627441406, 63.733253479003906, 63.90767288208008, 64.41374206542969, 64.35478210449219, 64.97139739990234, 64.5218276977539, 65.28831481933594, 65.61750030517578, 65.41851043701172, 64.65695190429688, 64.36705017089844, 64.31056213378906, 
            65.43817138671875, 64.92718505859375, 65.79928588867188, 65.65435028076172, 64.89525604248047, 63.738162994384766, 64.30074310302734, 65.24407958984375, 66.50435638427734, 65.57328033447266, 65.95652770996094, 66.51911163330078, 66.6885986328125, 67.5951156616211, 68.75220489501953, 68.88733673095703, 68.72273254394531, 68.79150390625, 68.64904022216797, 69.76927185058594, 69.83558654785156, 71.22116088867188, 71.19414520263672, 71.6166763305664, 72.13994598388672, 73.78591918945312, 73.06856536865234, 73.65080261230469, 73.30440521240234, 74.48360443115234, 76.0656967163086, 76.23765563964844, 77.8664321899414, 76.81498718261719, 76.48577117919922, 77.44389343261719, 78.30126953125, 77.77062225341797, 78.04822540283203, 78.42410278320312, 78.19808959960938, 75.89863586425781, 78.0457763671875, 79.679443359375, 79.56398010253906, 76.03622436523438, 75.827392578125, 78.33074951171875, 78.96949005126953, 79.8931884765625, 78.80722045898438, 79.1815185546875, 78.70378112792969, 80.57282257080078, 79.99906921386719, 80.01876068115234, 78.55358123779297, 79.69123840332031, 78.87371063232422, 77.08839416503906, 73.42667388916016, 70.9395523071289, 72.06491088867188, 67.3541488647461, 67.31475830078125, 73.5818099975586, 71.24490356445312, 74.549560546875, 72.13140106201172, 71.1734848022461, 65.54422760009766, 70.26482391357422, 67.82449340820312, 61.126502990722656, 68.44996643066406, 59.64408493041992, 62.266639709472656, 60.74235916137695, 60.276947021484375, 56.450233459472656, 55.250999450683594, 60.79407501220703, 60.459171295166016, 63.640716552734375, 61.0058479309082, 62.746826171875, 62.61878204345703, 59.32396697998047, 60.313880920410156, 59.44709014892578, 64.63309478759766, 63.8845100402832, 65.51959228515625, 65.99239349365234, 67.28765869140625, 70.6858901977539, 70.04074096679688, 70.59724426269531, 69.63934326171875, 68.19386291503906, 66.08596801757812, 67.98947143554688, 67.72599029541016, 69.68121337890625, 69.73046112060547, 68.60017395019531, 70.85335540771484, 72.34809112548828, 71.18334197998047, 72.19050598144531, 73.27399444580078, 74.02997589111328, 74.79582214355469, 76.57608795166016, 77.7810287475586, 76.89213562011719, 75.96373748779297, 76.43040466308594, 75.97853088378906, 77.76866912841797, 77.3193130493164, 78.82300567626953, 78.2353515625, 78.73905944824219, 78.20572662353516, 78.54647064208984, 78.58104705810547, 78.50450134277344, 79.4699478149414, 79.83783721923828, 80.27735137939453, 79.58598327636719, 81.8526840209961, 82.33662414550781, 84.9366455078125, 87.12186431884766, 82.9391098022461, 83.6551742553711, 84.68973541259766, 86.93421173095703, 86.813232421875, 86.84779357910156, 86.35148620605469, 88.61077117919922, 90.50214385986328, 88.90460205078125, 90.0848617553711, 87.31693267822266, 89.32929992675781, 90.0749740600586, 89.90459442138672, 89.90459442138672, 92.30957794189453, 92.02315521240234, 94.16636657714844, 94.57133483886719, 94.73675537109375, 94.29971313476562, 95.86023712158203, 96.51948547363281, 95.33183288574219, 95.13923645019531, 97.1441879272461, 95.80342102050781, 96.07256317138672, 91.69969940185547, 91.47251892089844, 93.64044952392578, 92.10216522216797, 93.86759948730469, 95.00343322753906, 104.94921112060547, 107.59368133544922, 108.31219482421875, 108.70480346679688, 112.4974136352539, 109.93971252441406, 111.53767395019531, 108.22054290771484, 111.81719207763672, 113.79606628417969, 113.69465637207031, 113.3978271484375, 114.34274291992188, 114.48619842529297, 117.026611328125, 123.05728149414062, 124.5290756225586, 123.50747680664062, 125.18706512451172, 123.6905288696289, 123.49015808105469, 127.67799377441406, 132.7637481689453, 130.01307678222656, 119.60411071777344, 119.68327331542969, 111.62919616699219, 116.08169555664062, 112.29212188720703, 110.8178482055664, 114.14237976074219, 114.32048034667969, 110.94647216796875, 109.17536163330078, 105.71229553222656, 108.9181137084961, 110.62985229492188, 105.9893569946289, 107.07774353027344, 111.09488677978516, 113.7466049194336, 112.88578796386719, 114.58763122558594, 115.55728912353516, 111.82707977294922, 115.27033996582031, 111.96560668945312, 113.86534118652344, 113.75650024414062, 115.73538970947266, 123.08696746826172, 119.82179260253906, 119.91085052490234, 119.43589782714844, 117.76373291015625, 114.7558364868164, 116.26968383789062, 115.6364517211914, 114.52825927734375, 113.82575988769531, 113.83564758300781, 115.3692855834961, 110.02628326416016, 114.1028060913086, 107.71099090576172, 107.62191772460938, 109.2743148803711, 113.73670959472656, 117.77363586425781, 117.63983917236328, 115.29080200195312, 114.94390869140625, 118.43275451660156, 118.15524291992188, 118.20479583740234, 119.235595703125, 118.33364868164062, 116.98567199707031, 117.59029388427734, 116.3017807006836, 112.84265899658203, 114.15097045898438, 115.00337219238281, 115.55841827392578, 117.99665069580078, 121.63419342041016, 121.99099731445312, 121.85224914550781, 121.1683349609375, 122.65506744384766, 123.27949523925781, 120.7024917602539, 122.14958953857422, 121.32693481445312, 120.7024917602539, 126.74851989746094, 126.67913818359375, 127.56126403808594, 125.5393295288086, 127.0954360961914, 130.71315002441406, 129.80126953125, 130.80233764648438, 135.4805908203125, 133.67666625976562, 132.536865234375, 131.51596069335938, 128.2650146484375, 129.850830078125, 125.47985076904297, 129.76161193847656, 130.88162231445312, 127.83879852294922, 127.66036987304688, 129.7318878173828, 127.7694320678711, 126.01507568359375, 126.69896697998047, 130.86178588867188, 135.6589813232422, 137.8395233154297, 141.65545654296875, 141.89334106445312, 140.80307006835938, 135.8770294189453, 130.7924346923828, 132.95314025878906, 133.79562377929688, 132.7549285888672, 136.17437744140625, 135.7524871826172, 135.9014129638672, 135.00804138183594, 134.39259338378906, 134.134521484375, 134.37274169921875, 132.2088165283203, 129.8760986328125, 128.75445556640625, 128.91326904296875, 125.07177734375, 124.93281555175781, 124.42656707763672, 120.09867858886719, 120.36669921875, 126.84859466552734, 124.19825744628906, 121.16081237792969, 119.24502563476562, 120.5255126953125, 115.50279235839844, 120.19793701171875, 119.09613037109375, 121.06153869628906, 120.13838195800781, 123.07658386230469, 124.64495086669922, 123.84091186523438, 119.64207458496094, 119.10604858398438, 122.48101806640625, 121.63726806640625, 
            119.20531463623047, 119.70162963867188, 120.31705474853516, 120.49573516845703, 119.01671600341797, 121.2501449584961, 122.09387969970703, 124.9725112915039, 125.28023529052734, 126.9577865600586, 129.399658203125, 132.0202178955078, 130.27317810058594, 133.43966674804688, 131.05735778808594, 133.50914001464844, 133.1716766357422, 133.84664916992188, 132.12939453125, 132.5165252685547, 130.968017578125, 133.33050537109375, 133.72755432128906, 133.39996337890625, 132.59593200683594, 132.4966583251953, 130.49156188964844, 131.5635986328125, 126.90814971923828, 127.15631103515625, 128.7842254638672, 129.47030639648438, 126.12939453125, 125.19474029541016, 122.07256317138672, 124.26007080078125, 126.72598266601562, 125.55268859863281, 124.14075469970703, 123.9816665649414, 126.58677673339844, 124.71746063232422, 126.37796783447266, 126.17910766601562, 126.12939453125, 124.56832122802734, 123.90211486816406, 123.57398223876953, 124.34956359863281, 122.83819580078125, 125.17485046386719, 125.1847915649414, 126.02001953125, 126.40779113769531, 125.39360046386719, 126.62654113769531, 129.73876953125, 128.90354919433594, 129.41064453125, 131.04132080078125, 129.71890258789062, 131.5484161376953, 133.2188720703125, 132.9404754638672, 132.6521453857422, 132.3538360595703, 134.0143585205078, 135.55552673339844, 136.1819610595703, 136.49020385742188, 139.16493225097656, 141.21324157714844, 143.7487335205078, 142.42628479003906, 144.28565979003906],
            atol = 0.001)
    end
    @testset "split_train_test" begin
        data = get_data("AAPL", "2016-07-11", "2021-07-10", "", "1d")
        adj_close = data[:, 6]
        train , test = split_train_test(adj_close)
        @test isapprox(train,
            [22.520645141601562, 22.622827529907227, 22.495101928710938, 22.94097137451172, 22.938642501831055, 23.18247413635254, 23.191762924194336, 23.21266746520996, 23.089588165283203, 22.91077423095703, 22.60424041748047, 22.44866180419922, 23.90699577331543, 24.22978401184082, 24.199596405029297, 24.626882553100586, 24.262292861938477, 24.566505432128906, 24.718265533447266, 25.094161987304688, 25.301958084106445, 25.404685974121094, 25.2155704498291, 25.199228286743164, 25.257593154907227, 25.56111717224121, 25.537765502929688, 25.500411987304688, 25.46772575378418, 25.533100128173828, 25.33464241027832, 25.414026260375977, 25.222572326660156, 25.115175247192383, 24.96808624267578, 24.9400634765625, 24.748615264892578, 24.77196502685547, 24.919057846069336, 25.152530670166016, 25.145524978637695, 25.29962158203125, 24.636545181274414, 24.07853126525879, 24.61786651611328, 25.203893661499023, 26.095779418945312, 26.982990264892578, 26.831235885620117, 26.51837921142578, 26.51603889465332, 26.511367797851562, 26.76119041442871, 26.315248489379883, 26.354934692382812, 26.403968811035156, 26.60476303100586, 26.191503524780273, 26.394630432128906, 26.270889282226562, 26.38295555114746, 26.394630432128906, 26.590749740600586, 26.630441665649414, 27.095069885253906, 27.153432846069336, 27.396244049072266, 27.312196731567383, 27.463960647583008, 27.445280075073242, 27.42660140991211, 27.34488296508789, 27.330873489379883, 27.223472595214844, 27.4686279296875, 27.608715057373047, 26.9876651763916, 26.728500366210938, 26.551063537597656, 26.509031295776367, 26.030410766601562, 26.053754806518555, 25.774492263793945, 25.542160034179688, 25.910606384277344, 26.063138961791992, 26.02089500427246, 25.29574966430664, 25.44594383239746, 24.8076229095459, 25.13617515563965, 25.812040328979492, 25.802644729614258, 25.828466415405273, 26.220373153686523, 26.236804962158203, 26.103036880493164, 26.23445701599121, 26.182823181152344, 26.157012939453125, 25.936416625976562, 25.6947021484375, 25.790918350219727, 25.60552406311035, 25.802644729614258, 26.056102752685547, 26.311899185180664, 26.74135398864746, 26.58881378173828, 27.03235626220703, 27.03235626220703, 
            27.18019676208496, 27.21540069580078, 27.372634887695312, 27.44538116455078, 27.47119903564453, 27.290496826171875, 27.3444766998291, 27.518136978149414, 27.400800704956055, 27.393756866455078, 27.18019676208496, 27.25764274597168, 27.22713851928711, 27.36559295654297, 27.67067527770996, 27.924121856689453, 27.952281951904297, 28.10247802734375, 27.985139846801758, 27.93585968017578, 28.161148071289062, 28.15880012512207, 28.109516143798828, 28.161148071289062, 28.179922103881836, 28.154104232788086, 28.60233497619629, 28.616416931152344, 28.61876106262207, 28.543672561645508, 28.47795867919922, 30.214563369750977, 30.162935256958008, 30.292001724243164, 30.57596778869629, 30.86696434020996, 30.986652374267578, 31.21055793762207, 31.13984489440918, 31.415607452392578, 31.823366165161133, 31.9388484954834, 31.901145935058594, 31.98834800720215, 32.21933364868164, 32.31595993041992, 32.17926788330078, 32.209896087646484, 32.27353286743164, 32.287681579589844, 32.94761657714844, 32.75199508666992, 32.94525909423828, 32.84156036376953, 32.88397979736328, 32.76142120361328, 32.68600082397461, 32.79441833496094, 32.808555603027344, 32.75906753540039, 33.10553741455078, 33.15974807739258, 32.994754791259766, 33.34122085571289, 32.95940399169922, 33.3317985534668, 33.21394729614258, 33.14796829223633, 33.204532623291016, 33.892738342285156, 33.968170166015625, 33.923397064208984, 33.85975646972656, 33.86918258666992, 34.121368408203125, 33.94459915161133, 33.85975646972656, 33.784332275390625, 33.744266510009766, 33.38130187988281, 33.421363830566406, 33.24459457397461, 33.428436279296875, 33.27994155883789, 33.157386779785156, 33.572208404541016, 33.53213882446289, 33.855045318603516, 34.0648078918457, 33.86446762084961, 33.890380859375, 33.85739517211914, 34.5479736328125, 34.76717758178711, 34.66111755371094, 34.53618621826172, 35.10892868041992, 36.06348419189453, 36.29446792602539, 36.12241744995117, 36.43480682373047, 36.943641662597656, 36.8489875793457, 36.79454803466797, 35.55915069580078, 36.10111618041992, 36.224178314208984, 36.44427490234375, 36.39930725097656, 36.29044723510742, 36.4158821105957, 36.35434341430664, 36.3685417175293, 36.15317153930664, 36.25257110595703, 36.78981018066406, 36.430076599121094, 36.55314254760742, 36.77088165283203, 36.68094253540039, 35.25857925415039, 34.41604995727539, 34.69294357299805, 34.35451126098633, 34.14861297607422, 33.67054748535156, 34.63377380371094, 34.31901168823242, 34.52254867553711, 34.46574401855469, 34.61957550048828, 34.510711669921875, 34.01608657836914, 34.51307678222656, 34.00424575805664, 34.08470916748047, 33.96164321899414, 34.10128402709961, 33.779415130615234, 34.12257766723633, 34.33083724975586, 34.44207763671875, 34.49177551269531, 34.972206115722656, 35.27278137207031, 35.39584732055664, 35.518917083740234, 35.74137496948242, 35.580440521240234, 35.56389236450195, 35.99460983276367, 36.1484489440918, 36.31884765625, 35.63250732421875, 35.381649017333984, 35.19941711425781, 35.51181411743164, 37.18977737426758, 36.818214416503906, 37.012271881103516, 37.58500671386719, 37.88557434082031, 38.11750793457031, 36.903411865234375, 37.416603088378906, 37.979705810546875, 38.39549255371094, 38.241058349609375, 37.50688934326172, 37.421356201171875, 37.35245132446289, 37.96306610107422, 38.01059341430664, 37.84189987182617, 37.98208236694336, 38.3646240234375, 38.706748962402344, 38.81129837036133, 38.96573257446289, 38.97761154174805, 38.509544372558594, 38.469154357910156, 38.314720153808594, 37.68984603881836, 38.37173080444336, 38.21968460083008, 37.932186126708984, 37.606689453125, 37.98683547973633, 37.699337005615234, 37.71359634399414, 37.08159255981445, 36.44483184814453, 36.08843994140625, 35.77006149291992, 36.38543701171875, 36.64441680908203, 36.418701171875, 36.618282318115234, 36.54462814331055, 36.70381546020508, 36.46622085571289, 36.92002868652344, 36.89864730834961, 37.026947021484375, 37.04119873046875, 37.19564437866211, 37.0649528503418, 37.3001823425293, 37.98683547973633, 38.12701416015625, 37.95832061767578, 37.060203552246094, 37.124359130859375, 37.105350494384766, 37.326324462890625, 37.162384033203125, 37.39997100830078, 38.74001693725586, 39.61198806762695, 40.16321563720703, 39.652381896972656, 39.9422492980957, 40.985286712646484, 41.40107727050781, 41.53414535522461, 41.8739013671875, 41.788368225097656, 41.65006637573242, 41.48314666748047, 40.85602951049805, 40.3171272277832, 40.79880142211914, 40.572269439697266, 40.531742095947266, 41.28524398803711, 41.71921157836914, 41.72161102294922, 41.51176452636719, 41.2685546875, 40.41250991821289, 40.977638244628906, 40.78688430786133, 40.48881530761719, 40.450660705566406, 40.300445556640625, 40.374366760253906, 40.38628387451172, 41.17315673828125, 40.941871643066406, 41.07779312133789, 41.06586456298828, 41.48314666748047, 42.067359924316406, 41.61906814575195, 41.57376480102539, 41.731143951416016, 41.731143951416016, 40.672420501708984, 40.67959213256836, 40.79404067993164, 40.3528938293457, 41.075401306152344, 41.06825256347656, 41.259010314941406, 41.72875213623047, 41.57376480102539, 41.569000244140625, 41.5594482421875, 41.79551696777344, 42.22711944580078, 42.01251220703125, 42.70640563964844, 42.74455642700195, 42.55379104614258, 42.20566177368164, 42.21519470214844, 41.54277038574219, 40.801185607910156, 40.89657211303711, 40.05007553100586, 39.814002990722656, 39.9236946105957, 40.00715255737305, 38.271236419677734, 37.3150520324707, 38.874507904052734, 38.04231643676758, 36.99552536010742, 37.44802474975586, 38.956398010253906, 39.34665298461914, 40.07209777832031, 41.41765594482422, 41.2835693359375, 41.14470672607422, 40.95796203613281, 41.30033874511719, 42.01860809326172, 42.84939956665039, 42.71054458618164, 42.645896911621094, 41.898887634277344, 42.188602447509766, 42.33464813232422, 42.298728942871094, 41.90607833862305, 42.363365173339844, 43.091217041015625, 43.5078125, 43.08881378173828, 42.72250747680664, 42.77278518676758, 42.62194061279297, 41.97072219848633, 41.95635223388672, 41.00584411621094, 40.42644500732422, 39.49030303955078, 41.364990234375, 40.30434036254883, 39.85901641845703, 40.170265197753906, 39.906898498535156, 40.31631088256836, 41.08724594116211, 41.37216567993164, 40.31391525268555, 40.71375274658203, 41.479896545410156, 41.285972595214844, 41.6929931640625, 41.834251403808594, 42.09521484375, 
            42.674617767333984, 42.5788459777832, 41.37216567993164, 39.67705154418945, 39.562129974365234, 39.01145553588867, 39.18144607543945, 39.31791305541992, 38.86302185058594, 39.56691360473633, 40.486305236816406, 42.27478790283203, 42.351402282714844, 44.01298522949219, 44.33142852783203, 44.54450988769531, 44.858154296875, 45.49979019165039, 45.32674789428711, 45.22099685668945, 44.81001281738281, 45.228206634521484, 44.94219970703125, 44.77876663208008, 45.09601974487305, 44.98305892944336, 45.27146911621094, 45.22099685668945, 45.324344635009766, 45.160911560058594, 45.06477737426758, 44.913360595703125, 45.723323822021484, 46.10546875, 46.461181640625, 46.622215270996094, 46.49722671508789, 46.07422637939453, 45.96125793457031, 46.213626861572266, 45.83387756347656, 45.857913970947266, 45.386844635009766, 45.3628044128418, 44.62975311279297, 44.824424743652344, 44.57447052001953, 44.44468688964844, 43.78373718261719, 44.3269157409668, 44.262020111083984, 44.584083557128906, 44.4903450012207, 44.98786163330078, 44.20433807373047, 44.56005859375, 45.177738189697266, 45.80503845214844, 45.74976348876953, 45.156097412109375, 45.91319274902344, 45.98529815673828, 45.88435363769531, 46.01414108276367, 45.76177215576172, 46.11749267578125, 46.01172637939453, 46.05259323120117, 46.38667297363281, 46.8241081237793, 46.67749786376953, 45.901180267333984, 45.644004821777344, 45.73533248901367, 
            48.42960739135742, 49.845245361328125, 49.98945236206055, 50.2490234375, 49.7779426574707, 49.81159973144531, 50.20335388183594, 50.053829193115234, 50.37702178955078, 50.589263916015625, 50.70743942260742, 51.45030975341797, 52.4777717590332, 51.966453552246094, 51.865150451660156, 51.867557525634766, 51.97367477416992, 52.135276794433594, 52.56459426879883, 52.98908996582031, 53.78017807006836, 54.27462387084961, 54.90171432495117, 55.077789306640625, 54.71841812133789, 53.80913162231445, 53.3749885559082, 52.65865707397461, 53.990020751953125, 53.319515228271484, 54.60746383666992, 53.987606048583984, 52.55012893676758, 52.636959075927734, 52.668312072753906, 53.06867980957031, 52.497066497802734, 53.25196838378906, 53.58964157104492, 53.16274642944336, 54.25531768798828, 54.445858001708984, 54.81247329711914, 55.2996711730957, 55.972591400146484, 54.9885368347168, 54.096134185791016, 53.97072219848633, 54.71841812133789, 52.18351364135742, 51.722843170166016, 53.570350646972656, 52.424705505371094, 53.57999801635742, 53.34845733642578, 52.10151672363281, 52.895023345947266, 53.21821212768555, 53.71989059448242, 51.87721252441406, 
            53.01321029663086, 52.16905212402344, 51.1898193359375, 51.44548034667969, 52.78648376464844, 53.59688949584961, 50.04176330566406, 48.62116622924805, 49.1469612121582, 50.63750076293945, 50.46082305908203, 49.48786163330078, 46.99494934082031, 46.525413513183594, 45.21118927001953, 46.32695007324219, 46.84004592895508, 44.98368453979492, 42.834449768066406, 42.78604507446289, 41.6993408203125, 42.26326370239258, 42.171295166015625, 43.79289627075195, 43.45647430419922, 43.221710205078125, 44.73197555541992, 42.76427459716797, 42.28746795654297, 40.779624938964844, 41.04827117919922, 40.813507080078125, 40.92726135253906, 41.3750114440918, 40.051116943359375, 39.67838668823242, 40.19390869140625, 38.94020080566406, 37.957550048828125, 36.48117446899414, 35.5372428894043, 38.03984069824219, 37.792964935302734, 37.81233596801758, 38.17780303955078, 38.22135543823242, 34.41423797607422, 35.883358001708984, 35.803489685058594, 36.48601150512695, 37.10559844970703, 37.22420120239258, 36.858734130859375, 36.30448913574219, 37.04751968383789, 37.500118255615234, 37.722782135009766, 37.95513153076172, 37.10318374633789, 37.25324249267578, 36.957969665527344, 38.182640075683594, 37.82927703857422, 37.437191009521484, 39.995445251464844, 40.2834587097168, 40.302825927734375, 41.4476318359375, 42.15677261352539, 42.171295166015625, 41.37260055541992, 41.42120361328125, 41.183006286621094, 41.53788375854492, 41.36529541015625, 41.5160026550293, 41.42363739013672, 41.547603607177734, 41.814979553222656, 41.57920837402344, 42.0434684753418, 42.3497314453125, 42.37403869628906, 42.505287170410156, 42.087215423583984, 42.52960205078125, 42.743499755859375, 42.66571807861328, 42.420223236083984, 41.92921829223633, 42.02888107299805, 43.484859466552734, 43.973426818847656, 44.167877197265625, 44.65886306762695, 45.23980712890625, 45.701637268066406, 45.33945846557617, 45.73566436767578, 47.42012405395508, 46.438133239746094, 45.876651763916016, 45.402652740478516, 45.81101608276367, 45.87178421020508, 46.17074966430664, 46.48431396484375, 47.16004180908203, 47.48332595825195, 47.565975189208984, 47.88439178466797, 48.63789749145508, 48.49205780029297, 48.7642936706543, 48.35836410522461, 48.338932037353516, 48.42643737792969, 48.43129348754883, 49.37439727783203, 49.55183410644531, 49.714691162109375, 50.43173599243164, 50.35395431518555, 49.89699172973633, 49.658790588378906, 49.734130859375, 48.77643966674805, 51.17066192626953, 50.83766174316406, 51.469635009765625, 50.6748046875, 49.30876922607422, 49.318485260009766, 48.78860092163086, 48.11270523071289, 45.316429138183594, 46.03379440307617, 46.58524703979492, 46.38028335571289, 46.11675262451172, 44.6746940612793, 45.5311393737793, 44.599056243896484, 43.8377571105957, 43.669395446777344, 43.48883819580078, 43.28143310546875, 
            43.505916595458984, 42.7177848815918, 42.285888671875, 43.83287811279297, 44.54048156738281, 45.194419860839844, 46.397369384765625, 46.990299224853516, 47.534420013427734, 47.383148193359375, 47.373382568359375, 47.02933120727539, 47.3099365234375, 48.42258834838867, 48.281070709228516, 48.66904067993164, 48.50311279296875, 48.45431900024414, 47.7198600769043, 48.75200271606445, 48.737361907958984, 48.293270111083984, 49.17900848388672, 49.4669303894043, 49.876853942871094, 49.83294677734375, 48.80568313598633, 49.103370666503906, 49.58893585205078, 49.227806091308594, 49.60601806640625, 50.07206726074219, 49.89881896972656, 49.61821746826172, 50.181861877441406, 49.432777404785156, 50.562503814697266, 50.95779800415039, 50.91632080078125, 50.51371765136719, 50.689388275146484, 51.162757873535156, 50.94314956665039, 51.98261260986328, 50.857749938964844, 49.78169631958008, 47.17573165893555, 48.06878662109375, 48.566551208496094, 49.637733459472656, 49.228702545166016, 49.10378646850586, 51.18324661254883, 49.65977096557617, 49.41240310668945, 50.57826614379883, 51.52125930786133, 51.52370071411133, 52.08214569091797, 52.03805923461914, 49.63283920288086, 50.5758171081543, 50.005126953125, 50.3406867980957, 51.19304656982422, 51.12690734863281, 50.38232421875, 51.23713684082031, 52.23890686035156, 52.23400115966797, 52.45689010620117, 53.076568603515625, 54.764137268066406, 54.64167404174805, 53.578678131103516, 53.8603401184082, 54.05628967285156, 54.56330108642578, 54.11997604370117, 53.3288459777832, 53.57133102416992, 53.316593170166016, 54.137115478515625, 53.85789489746094, 53.5958251953125, 54.85721969604492, 55.009071350097656, 53.63010787963867, 54.0856819152832, 55.601806640625, 55.614051818847656, 54.96254348754883, 55.60670852661133, 56.35619354248047, 57.85517501831055, 57.771888732910156, 57.637184143066406, 57.40449905395508, 57.62738800048828, 57.90415573120117, 58.90837097167969, 58.77366256713867, 59.56233596801758, 59.660316467285156, 60.39510726928711, 61.000083923339844, 59.58928298950195, 59.58193588256836, 60.92905807495117, 62.65827560424805, 63.06975555419922, 62.979129791259766, 63.006072998046875]
            , atol = 0.001)
        @test isapprox(test, 
            [63.73323440551758, 63.907676696777344, 64.41374206542969, 64.35477447509766, 64.97140502929688, 64.52183532714844, 65.28831481933594, 65.61750793457031, 65.41852569580078, 64.65694427490234, 64.3670654296875, 64.31055450439453, 65.43816375732422, 64.92718505859375, 65.7992935180664, 65.65435791015625, 64.89525604248047, 63.73814392089844, 64.30073547363281, 65.24409484863281, 66.50435638427734, 65.57328796386719, 65.9565200805664, 66.51908874511719, 66.68861389160156, 67.59512329101562, 68.75220489501953, 
            68.88733673095703, 68.72272491455078, 68.79151153564453, 68.64903259277344, 69.76927185058594, 69.83560180664062, 71.2211685180664, 71.19412994384766, 71.6166763305664, 72.13996124267578, 73.78591918945312, 73.06856536865234, 73.65078735351562, 73.30441284179688, 74.48360443115234, 76.0656967163086, 76.23765563964844, 77.86642456054688, 76.81497955322266, 76.48577880859375, 77.44389343261719, 78.30125427246094, 77.77062225341797, 78.04822540283203, 78.4240951538086, 78.19808197021484, 75.89864349365234, 78.0457763671875, 79.6794662475586, 79.5639877319336, 76.03622436523438, 75.82740783691406, 78.33074188232422, 78.96947479248047, 79.89318084716797, 78.80721282958984, 79.1815185546875, 78.70379638671875, 80.57283782958984, 79.99906921386719, 80.01876831054688, 78.55358123779297, 79.69125366210938, 78.87369537353516, 77.08838653564453, 73.42666625976562, 70.93954467773438, 72.06491088867188, 67.35416412353516, 67.31475830078125, 73.581787109375, 71.2448959350586, 74.549560546875, 72.13140106201172, 71.17347717285156, 65.54421997070312, 70.26481628417969, 67.8244857788086, 61.12650680541992, 68.44996643066406, 59.644081115722656, 62.26663589477539, 60.74235534667969, 60.276939392089844, 56.450225830078125, 55.25099563598633, 60.7940673828125, 60.459171295166016, 63.64072036743164, 61.00584411621094, 62.746829986572266, 62.618778228759766, 59.32395935058594, 60.313880920410156, 59.447086334228516, 64.63310241699219, 63.884490966796875, 65.51959991455078, 65.99239349365234, 67.28767395019531, 70.68590545654297, 70.04074096679688, 70.59725952148438, 69.63935852050781, 68.19386291503906, 66.0859603881836, 67.9894790649414, 67.72599029541016, 
            69.68122100830078, 69.73046112060547, 68.60017395019531, 70.85336303710938, 72.34808349609375, 71.18333435058594, 72.19049835205078, 73.27398681640625, 74.02998352050781, 74.79582214355469, 76.57608032226562, 77.7810287475586, 76.89213562011719, 75.9637451171875, 76.43040466308594, 75.9785385131836, 77.7686767578125, 77.31930541992188, 78.82301330566406, 78.23535919189453, 78.73905944824219, 78.20572662353516, 78.54647064208984, 78.58103942871094, 78.50450134277344, 79.46994018554688, 79.83783721923828, 80.27735137939453, 79.58599090576172, 81.85267639160156, 82.33663940429688, 84.93665313720703, 87.12186431884766, 82.93910217285156, 83.65515899658203, 84.68974304199219, 86.93419647216797, 86.81322479248047, 86.84779357910156, 86.35148620605469, 88.61076354980469, 90.50215148925781, 88.90460205078125, 90.0848617553711, 87.31692504882812, 89.32930755615234, 90.07498168945312, 89.90460968017578, 89.90460968017578, 92.30957794189453, 92.02314758300781, 94.16637420654297, 94.57132720947266, 94.73675537109375, 94.29971313476562, 95.8602294921875, 96.51949310302734, 95.33184051513672, 95.13922882080078, 97.1441879272461, 95.80342864990234, 
            96.07257080078125, 91.69969177246094, 91.4725341796875, 93.64044189453125, 92.10216522216797, 93.86761474609375, 95.00343322753906, 104.94921875, 107.59367370605469, 108.31219482421875, 108.70479583740234, 112.49742126464844, 109.93971252441406, 111.53767395019531, 108.22054290771484, 111.81719207763672, 113.79606628417969, 113.69466400146484, 113.3978271484375, 114.34274291992188, 114.4862060546875, 117.026611328125, 123.05728149414062, 124.5290756225586, 123.50747680664062, 125.18705749511719, 123.6905288696289, 123.49016571044922, 127.67796325683594, 132.76373291015625, 130.01307678222656, 119.60411071777344, 119.68326568603516, 
            111.62919616699219, 116.08169555664062, 112.29212951660156, 110.81784057617188, 114.14237213134766, 114.32048034667969, 110.94647216796875, 109.17537689208984, 105.7123031616211, 108.91810607910156, 110.62984466552734, 105.98934173583984, 107.07774353027344, 111.09488677978516, 113.7466049194336, 112.88578033447266, 114.58763122558594, 115.55729675292969, 111.82707977294922, 115.27033996582031, 111.96560668945312, 113.86534881591797, 113.75650024414062, 115.73538208007812, 123.08695983886719, 119.8218002319336, 119.91085052490234, 119.4359130859375, 117.76374816894531, 114.7558364868164, 116.26969146728516, 115.63644409179688, 114.52825927734375, 113.82575225830078, 113.83565521240234, 115.36929321289062, 110.02628326416016, 114.1028060913086, 107.71099853515625, 107.62194061279297, 109.27432250976562, 113.73670196533203, 117.77364349365234, 117.63983917236328, 115.29080200195312, 114.94390106201172, 118.4327621459961, 118.15524291992188, 118.20479583740234, 119.235595703125, 118.3336410522461, 116.98567962646484, 117.59027862548828, 116.30177307128906, 112.84265899658203, 114.1509780883789, 115.00337219238281, 115.55841827392578, 117.99665832519531, 121.63418579101562, 121.99099731445312, 121.85224151611328, 121.16834259033203, 122.65507507324219, 123.27949523925781, 120.70249938964844, 122.14958190917969, 121.32691955566406, 120.70249938964844, 126.74853515625, 126.67914581298828, 127.561279296875, 125.5393295288086, 127.09542846679688, 130.713134765625, 129.80128479003906, 130.8023223876953, 135.4805908203125, 133.67666625976562, 132.536865234375, 131.51596069335938, 128.26499938964844, 129.85081481933594, 125.4798583984375, 129.76162719726562, 130.8816375732422, 127.83879852294922, 127.66038513183594, 129.7318878173828, 127.76940155029297, 126.01507568359375, 126.69895935058594, 130.86180114746094, 135.6589813232422, 137.83953857421875, 141.65545654296875, 141.89334106445312, 140.8030548095703, 135.8770294189453, 130.79241943359375, 132.95315551757812, 133.7956085205078, 132.75491333007812, 136.1743621826172, 135.7525177001953, 135.9014129638672, 135.00802612304688, 134.39260864257812, 134.13450622558594, 134.37274169921875, 132.2088165283203, 129.87611389160156, 128.75445556640625, 128.91326904296875, 125.07178497314453, 124.93280792236328, 124.42655944824219, 120.09868621826172, 120.36669921875, 126.84858703613281, 124.1982650756836, 121.16079711914062, 119.2450180053711, 120.52552032470703, 115.5027847290039, 120.19795227050781, 119.09613800048828, 121.06153106689453, 120.13839721679688, 123.07658386230469, 
            124.64495086669922, 123.84091186523438, 119.64207458496094, 119.1060562133789, 122.48100280761719, 121.63726806640625, 119.20531463623047, 119.70162963867188, 120.31706237792969, 120.49574279785156, 119.01671600341797, 121.25013732910156, 122.09387969970703, 124.97252655029297, 125.28022766113281, 126.9577865600586, 129.399658203125, 132.0202178955078, 130.27317810058594, 133.43968200683594, 131.05734252929688, 133.50917053222656, 133.1716766357422, 133.84664916992188, 132.12940979003906, 132.51654052734375, 130.968017578125, 133.33050537109375, 133.72755432128906, 133.39996337890625, 132.59593200683594, 132.49668884277344, 130.49156188964844, 131.5635986328125, 126.90814971923828, 127.15631103515625, 128.7842254638672, 129.47032165527344, 126.12938690185547, 125.19474029541016, 122.07257080078125, 124.26007843017578, 126.72599029541016, 125.55268096923828, 124.14076232910156, 123.9816665649414, 126.58677673339844, 124.71746063232422, 126.37797546386719, 126.17911529541016, 126.12938690185547, 124.56831359863281, 123.90211486816406, 123.57398223876953, 124.34956359863281, 122.83820343017578, 125.17485046386719, 125.18479919433594, 126.02001953125, 126.40780639648438, 125.39360809326172, 126.62654876708984, 129.73875427246094, 128.90354919433594, 129.41064453125, 131.04132080078125, 129.71888732910156, 131.54844665527344, 133.21888732910156, 132.94049072265625, 132.65211486816406, 132.3538360595703, 134.01434326171875, 135.55552673339844, 136.18197631835938, 136.49020385742188, 139.1649169921875, 141.21322631835938, 143.7487335205078, 142.42628479003906, 144.28564453125]
            , atol = 0.001)
    end

    @testset "standardize" begin
        data = get_data("AAPL", "2016-07-11", "2021-07-10", "", "1d")
        adj_close = data[:, 6]
        train, test = split_train_test(adj_close)
        @test isapprox(standardize(test, train),
        [2.5805529225374806, 2.599800199376338, 2.655637463256951, 2.649131211089288, 2.717167803008945, 2.6675640489357515, 2.752134383749065, 2.7884562583163213, 2.766501340114119, 2.6824714392368443, 2.650487346713833, 2.644252153311597, 2.768668126642721, 2.7122887452312536, 2.808513765160532, 2.7925221397977302, 2.708765823078107, 2.5810946191696313, 2.643168760047296, 2.7472553259713735, 2.886307630838163, 2.78357720053863, 2.8258615261478783, 2.8879331416333187, 2.906637880042618, 3.006658564485286, 3.1343264012041296, 3.1492363168974467, 3.131073696019002, 3.138663341450966, 3.1229427748535916, 3.246545571888434, 3.2538641585549706, 3.406742144053368, 3.4037588140388517, 3.4503809216923447, 3.508118122323173, 3.689726653362046, 3.6105766520598706, 3.674816737668729, 3.6365991353382983, 3.766706500945987, 3.9412683458811593, 3.960241617663661, 4.1399535791419515, 4.023941269336482, 3.987618552971817, 4.0933331550832746, 4.187930980622581, 4.129383129087696, 4.1600127695809785, 4.201484760691353, 4.176547354272043, 3.922836349832104, 4.159742552612959, 4.339997473419513, 4.327256027849614, 3.93801648249344, 3.9149764874321207, 4.191184527605117, 4.261659806616211, 4.36357790241687, 4.24375645933948, 4.285055881981181, 4.23234589547188, 4.438568582725331, 4.375261208644713, 4.37743472955258, 4.215771746302633, 4.341298050415119, 4.25109188195418, 4.0541079212552775, 3.6500880970066425, 3.375668876325985, 3.49983736121911, 2.980072076943392, 2.975724193330249, 3.667203521909337, 3.4093601339927435, 3.773983839539524, 3.5071736256312183, 3.4014800684549646, 2.780369952413543, 3.301221997143195, 3.0319655199667785, 2.2929368438891102, 3.1009785968799, 2.129371819395427, 2.4187342067670237, 2.2505510816921785, 2.1991989144022384, 1.7769743794047514, 1.644656032904532, 
        2.256256784524682, 2.2193056663948267, 2.570345287166141, 2.279623396980367, 2.4717169356365685, 2.457588207938023, 2.094050841946472, 2.2032748974525456, 2.1076361894180504, 2.6798408223363466, 2.5972419770529425, 2.777653472177413, 2.8298196575610435, 2.9727358125312837, 3.3476833214917296, 3.2764984072655574, 3.337902477406327, 3.232211445622298, 3.0727211414828095, 2.8401434609747085, 3.0501702307156306, 3.021097915427442, 3.2368303880008678, 3.2422633484731276, 3.11755190425174, 3.3661599328034177, 3.5310815138203497, 3.4025676707063064, 3.51369418835482, 3.633242047274559, 3.7166557524490615, 3.801155376280089, 3.99758206709479, 4.130531340752425, 4.032454366525196, 3.930019407115927, 3.981508787383397, 3.9316516522903475, 4.129168470748615, 4.079586603408034, 4.245499821771777, 4.1806603764083095, 4.236236683092393, 4.177390835275019, 4.214987191118229, 4.218801375174598, 4.210356463575944, 4.316879191199235, 4.357471504018083, 4.405965769107323, 4.329683771574746, 4.5797809397414575, 4.633179516530633, 4.9200548134598225, 5.161162427104801, 4.699652890663337, 4.778659786406126, 4.892811723939564, 5.1404558944589, 5.127108354755126, 5.130922538811496, 5.076161933815919, 5.325441716699308, 5.534130028561257, 5.3578627020771545, 5.488087919321986, 5.18268466143921, 5.404723038397156, 5.486997791678419, 5.4681996137568145, 5.4681996137568145, 5.733554359946413, 5.70195075985189, 5.938425962359768, 5.983106885190046, 6.001359578391163, 5.953138055662167, 6.125319297527065, 6.1980598533635165, 6.067018934430179, 6.04576691706379, 6.266986225143597, 6.11905211582332, 6.148748202990954, 5.666261916935569, 5.641198240905035, 5.8803966580283085, 5.710669255608195, 5.905462017653659, 6.030783764995963, 7.128162651436105, 7.419941418267823, 7.499220214573446, 7.542538267399914, 7.961001651577746, 7.678794121276799, 7.855106904820942, 7.489107702309229, 7.885947836463673, 8.104289039204986, 8.09310070985314, 8.060348898093887, 8.16460719068923, 8.180436349152256, 8.460734682931498, 9.126135127805812, 9.288527107611225, 9.175807909266474, 9.361126241483104, 9.196005154480439, 9.17389787094736, 9.63596299367821, 10.197106829551997, 9.893610242798703, 8.74512583570921, 8.753859483818863, 7.865205106529221, 8.356476390336155, 7.938350566918996, 7.775683319361115, 8.142499065358743, 8.16215082585222, 7.78987602366268, 7.594460331535179, 7.212358386402787, 7.56607408113464, 7.7549405894266625, 7.2429257338878665, 7.36301571033846, 7.806251508643602, 8.098831666607888, 8.003851665045277, 8.191627203896326, 8.298616287283737, 7.887038805904648, 8.26695460316805, 7.902323321444596, 8.111933401468479, 8.099923477846271, 8.31826552238499, 9.12940971972355, 8.76914484115622, 8.778970300504254, 8.726567570048932, 8.54206746491303, 8.210186311354013, 8.377219120270608, 8.307349093595981, 8.18507633646603, 8.107564472920133, 8.108657125955924, 8.277872715551876, 7.6883459964671825, 8.138133504000029, 7.432886578810496, 7.423060277665053, 7.605377602121596, 8.097739013572097, 8.543159276151414, 8.528395833207115, 8.269212303816733, 8.230936617465138, 8.61588383783711, 8.585263457115316, 8.59073093128131, 8.7044653373003, 8.604947205910303, 8.456218439836723, 8.522927517243714, 8.380758878371918, 7.999093826094361, 8.143448612835146, 8.237498428261741, 8.298740031502735, 8.567765856189316, 8.96911634085668, 9.008485522041472, 8.99317575257928, 8.917717032911881, 9.081757252042472, 9.15065331911586, 8.866317724967084, 9.025983122967471, 8.935213792040472, 8.866317724967084, 9.53341354982143, 9.525757402394222, 9.623088544117822, 9.399994553210043, 9.571688394375617, 9.970851889376581, 9.8702419467482, 9.980692501077963, 10.496874253787146, 10.297836307412336, 10.172075141822972, 10.059432547042364, 9.700734253451616, 9.87570689552197, 9.393432742413442, 9.865866283820589, 9.989443826933186, 9.653708924839615, 9.63402349244981, 9.862584957523584, 9.646051935614999, 9.452486514190632, 9.527943550263211, 9.987255153671972, 10.516557160784727, 10.757151278010728, 11.17818466967567, 11.204431912862077, 11.084134012451667, 10.540615730709918, 9.979599848042172, 10.218006975601776, 10.310959929005538, 10.196133711748164, 10.573422259300703, 10.52687759700876, 10.543306115226395, 10.444733322325762, 10.376830576194001, 10.348352569875974, 10.374638535743156, 10.135879536866941, 9.878498295727427, 9.754738924374667, 9.77226177922291, 9.348407524443227, 9.333073342856197, 9.277215875837788, 8.799695352693135, 8.829266853844363, 9.544452881032031, 9.252026771993439, 8.916884495275212, 8.705504957099379, 8.846790550490015, 8.292601644802438, 8.810647978770696, 8.689078122476557, 8.905931869197651, 8.804076908202605, 9.128264875248455, 9.301312326646348, 9.212597823192667, 8.74931461961221, 8.690172459107165, 9.06255080237791, 8.969456427009575, 8.701124243387317, 8.755885690180301, 8.823790119906878, 8.843505015205968, 8.68031501145762, 8.926741942924757, 9.0198371600905, 9.337455740163074, 9.371406271431546, 9.556501527335016, 9.82592804758788, 10.115070304937243, 9.922308800037667, 10.271688396320092, 10.008830421243093, 10.279355487113607, 10.242117736966273, 10.316591553666123, 10.127118109442819, 10.169832593527637, 9.998974657188365, 10.259642275409334, 10.303451096124759, 10.267305999013216, 10.178592337356942, 10.167642236671606, 9.946404409048819, 10.064688730058911, 9.55102479339753, 9.578405937692727, 9.758023617861305, 9.833724775182251, 9.465099164757081, 9.361973931473122, 9.01748601992951, 9.258847014594345, 9.53092603848032, 9.401467698674322, 9.245682144928143, 9.228128143575796, 9.515565761173638, 9.309312769213493, 9.492527449707135, 9.470586000263463, 9.465099164757081, 9.292856471681388, 9.21935072200092, 9.183145857273399, 9.268720456394645, 9.101962915230517, 9.35977936563005, 9.36087706945029, 9.453031998911118, 9.495818877573038, 9.383916222714202, 9.519954051062372, 9.863342575190927, 9.771189329324915, 9.82714023585563, 10.00706264668596, 9.86115053474008, 10.063016920406307, 10.247326779327963, 10.21660959190423, 10.184791333470628, 10.151880422001232, 10.335094260697465, 10.505142387930087, 10.574262373114045, 10.60827098840368, 10.903388323756158, 11.129390724709125, 11.40914862455233, 11.263234829011633, 11.46838927535413]
        , atol = 0.001)
    end

end